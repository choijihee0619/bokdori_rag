# bokdori_rag

# 🐶 노인을 위한 복도리 AI 강아지 비서 인형 프로젝트

---

## 1. 프로젝트 개요

복도리 AI 비서 인형은 노인의 일상 안전과 정서적 돌봄, 금융 사기 예방, 소통 강화를 위해 카메라/마이크/스피커를 탑재한 인형형 IoT 기기와 AI 기반 백엔드 시스템이 통합된 서비스입니다. 음성/영상 인식, LLM 대화, 감정분석, 금융퀴즈, 실시간 안전 모니터링 등 다양한 기능을 제공합니다.

---

## 2. 주요 기능 및 흐름

### 2-1. 카메라 객체 인식 (YOLO)

#### 역할 및 시나리오

* **24시간 동작**: 실시간으로 카메라 입력 모니터링
* **사람 인식**:

  * YOLO 모델로 ‘사람’ 감지 시,
  * LLM이 시간대에 맞는 인사 및 건강 질문 자동 생성/발화
  * 객체 우선순위(예: 음식, 감정 등) 따라 맞춤 발화
  * 주요 이벤트(존재 여부, 식사, 감정 등) DB 저장
* **낙상 감지**:

  * 낙상 시나리오 학습/탑재
  * 낙상 징후 감지 시 대화 시도, 반응 없으면 가족·관리자 알림

### 2-2. 음성 대화 (STT, TTS, LLM)

* **Wakeword(“복돌아”, “복도라”, 등) 인식**

  * Picovoice 등 wakeword engine 사용
* **다중턴, 역할 기반 대화**

  * LLM 프롬프트 기반 감정/정보/상황 맞춤 대화
* **음성 감지**

  * VAD(Voice Activity Detection)로 음성 시작·끝 자동 감지
* **STT**: 음성→텍스트 변환 (Google, Whisper 등)
* **TTS**: 텍스트→음성 변환 (Google, Naver, ElevenLabs 등)

### 2-3. 금융퀴즈 및 보이스피싱 예방

* **객체 인식 후, 일정 시간에 맞춰 자동 발화**
* **금융 퀴즈/시나리오**

  * RAG(지식검색)로 사전 저장된 시나리오/퀴즈 선택
  * LLM이 사용자 상황에 맞게 출력
* **보이스피싱 시나리오 대응**

  * 위험 행동/의심 상황 발생 시, 경고/상담 유도

### 2-4. 감정일기/대화 분석 웹

* **DB(슈퍼베이스 또는 몽고DB)에 일일 대화/감정 저장**
* **GPT API를 통해 일기 형식 감정분석/요약**
* \*\*웹 프론트(Bolt 등)\*\*에서 감정일기 조회/시각화

---

## 3. 사용 기술/AI 모델

| 구분     | 주요 기술/툴                    | 설명                 |
| ------ | -------------------------- | ------------------ |
| 객체인식   | YOLOv8, Ultralytics        | 실시간 인물/이벤트 감지      |
| 음성 인식  | Picovoice, Google STT, VAD | 웨이크워드/음성분할/텍스트변환   |
| 음성 합성  | Google TTS, Naver CLOVA    | 텍스트→음성             |
| LLM    | OpenAI GPT-4.1-nano        | 자연어 대화/상황별 응답      |
| RAG    | LangChain+Pinecone         | 금융 퀴즈/시나리오 검색      |
| DB     | Supabase(추천) or MongoDB    | 대화, 감정, 이벤트, 알림 저장 |
| 감정일기분석 | GPT API                    | 대화내용 감정분석/요약       |
| 웹 프론트  | Bolt(HTML/CSS/JS)          | 일기/상태 시각화          |
| 백엔드    | FastAPI                    | API 통신             |

---

## 4. 시스템 구조도 (텍스트 버전)

```
[인형(카메라/마이크/스피커)]
    │         │
    ▼         ▼
[YOLO 객체인식]    [Wakeword/VAD]
    │         │
    ▼         ▼
[이벤트 발생]      [음성 녹음]
    │         │
    └──→ [STT 변환] ───────────────┐
          │                       │
[객체정보+텍스트]                 [텍스트]
    │                             │
    └────── [백엔드 API 서버] ───────┘
                │
         ┌──────┼─────────┐
         │    LangChain   │
         │  (GPT-4.1-nano │
         │   + Pinecone)  │
         └──────┬─────────┘
                │
      [슈퍼베이스/몽고DB 기록]
                │
          [TTS 변환]
                │
         [스피커로 출력]
```

* **웹(감정일기)**:

  * \[DB] ↔ \[GPT 감정요약] ↔ \[웹(Bolt) 시각화]

---

## 5. 개발/운영 단계(예시)

1. YOLO 객체인식 및 낙상 감지 모델 튜닝/테스트
2. Wakeword+STT+TTS+VAD 연동 및 안정화
3. LangChain+GPT-4.1-nano+RAG 시나리오 챗봇 개발
4. DB(Supabase) 설계 및 데이터 연동, 감정일기 자동화
5. Bolt 웹 UI와 백엔드 API 연결
6. 통합 테스트 및 사용자 피드백 반영

---

## 6. 예상 효과 및 가치

* 노인 안전 및 돌봄 효율 대폭 향상(실시간 감시, 낙상 예방)
* 정서 지원(대화, 감정일기), 고독감 완화
* 금융사기 위험 예방, 자산보호
* 가족/관리자와의 소통·관리 채널 강화
* 쉽고 친근한 UI, 저렴한 구축·운영비

---

## < 최지희 담당 - LangChain Lag LLM >
# 복도리 AI 인형 프로젝트: 금융교육/사기예방 시나리오 챗봇 구조 및 기술 선택 정리

## 1. LangChain 사용 이유와 LangGraph 비교

### LangChain의 특징 및 채택 이유

* 다양한 대형언어모델(LLM)과 검색엔진, 데이터베이스와의 연동이 쉽다.
* RAG(Retrieval-Augmented Generation) 파이프라인 구축에 최적화되어 있다.
* 프롬프트 템플릿, 체인, 에이전트, 임베딩 등 챗봇에 필요한 기능을 쉽게 조합·커스터마이즈할 수 있다.
* FastAPI, Streamlit 등 Python 생태계와의 통합과 협업이 용이하다.
* Pinecone, Meilisearch 등 외부 데이터베이스 및 검색엔진 연동 공식 지원.
* 현업 및 오픈소스 AI 챗봇에서 RAG-LLM 연결의 표준 도구로 가장 널리 사용된다.

### LangGraph와의 비교

* LangGraph는 LangChain의 확장으로, 멀티에이전트 워크플로우·분기·그래프 기반 대화 흐름 설계에 특화.
* 복도리 챗봇의 1차 목표는 시나리오/FAQ 기반 RAG 구조와 단일 LLM 응답이므로 복잡한 그래프 분기 구조는 필요성이 낮다.
* 단순 RAG+LLM+시나리오 챗봇 구현에는 LangChain이 문서, 예제, 협업 등 실무에 훨씬 적합하다.

## 2. LLM(대형언어모델) 선정 및 활용 목적

### 복도리 전체 프로젝트에서 LLM 활용 목적

* 노인 사용자의 자연스러운 일상 대화, 질의응답, 금융교육, 사기예방 상담 등 다양한 기능을 유연하게 처리한다.
* 사전 시나리오 외에도, 새로운 자연어 질문에 대해 AI가 맥락을 파악해 적절히 안내하고 조언할 수 있다.
* 감정일기, 건강·생활상담 등 맞춤형 답변 생성도 실시간 가능하다.

### 금융사기 예방 및 금융 퀴즈 파트에서 LLM이 필요한 이유

* 금융사기 사례, 예방법, 경고문, 실제 사례 등 다양한 FAQ·시나리오를 준비해도 실제 노인 사용자는 다양한 표현·상황으로 질문한다.
* LLM을 활용하면 질문 표현이 달라도 의미와 문맥을 이해하고 적합한 답변 제공이 가능하다.
* 금융 퀴즈, 시나리오 기반 상담도 LLM이 상황별로 유연하게 변형·확장해 자연스럽고 몰입도 높은 교육이 가능하다.
* 사기 위험 징후 포착 시, LLM이 사용자의 상태·맥락을 반영한 맞춤 경고·상담을 생성할 수 있다.
* 최신 LLM일수록 최신 금융사기 수법, 신종 금융 사례 등 도메인 지식이 더 잘 반영된다.
* LLM만으로는 도메인 특화 지식, 최신 정보 반영, 사실 정확성이 부족할 수 있기 때문에 RAG와 결합해야 한다(아래 3번).

## 3. RAG(Retrieval-Augmented Generation) 구조와 Pinecone(벡터데이터베이스) 사용 목적

* RAG는 LLM이 자체로 생성하는 답변만으로는 도메인 지식, 최신 정보, 사실성에 한계가 있으므로,
  외부 데이터베이스(FAQ, 시나리오, 금융상담, 금융 퀴즈 등)에서 '의미적으로 관련 있는' 문서를 벡터 임베딩 기반으로 검색·추출하고, 이를 LLM에 함께 입력하여 더 정확하고 신뢰도 높은 답변을 생성하는 구조이다.
* RAG의 도입 목적 중 하나는 LLM의 도메인 지식 한계 및 knowledge cut-off 문제(최신 정보 반영 불가 등)를 보완하여, 항상 최신/정확한 정보를 활용하도록 하는 것이다.
* Pinecone은 임베딩된 텍스트 벡터를 저장·관리·검색하는 대표적인 벡터 데이터베이스이다.
* 수십만·수백만 건의 문서 중에서도 빠르고 효율적으로 의미 유사도가 높은 데이터를 실시간 검색할 수 있다.
* Pinecone을 쓰는 이유:

  * 다양한 질의(오타, 표현 변화, 구어체 등)에도 의미가 비슷한 답변/시나리오/상담 문서를 찾을 수 있다.
  * 금융사기·금융상담 시나리오, 금융교육 FAQ 등 유사도 높은 대화문 추출로 LLM의 정확도·신뢰성을 높인다.
  * 대량의 시나리오·퀴즈 데이터가 누적되어도 문맥 기반 검색이 필요하다.
  * RAG 구조에서 LLM knowledge cut-off, 도메인 특화 한계, 최신성·정확성 문제를 실질적으로 보완한다.

## 4. Meilisearch 역할 및 활용

* Meilisearch는 오픈소스 키워드·텍스트 일치 기반 초고속 검색엔진이다.
* 챗봇 RAG 파이프라인보다는, 운영·관리·검색 UI 또는 프론트엔드에서 목록/필터/검색 기능에 적합하다.
* 대표적 활용 예시:

  * 금융 퀴즈, 상담 시나리오, 공지사항 등 특정 키워드나 카테고리로 문서를 빠르게 검색·필터
  * 운영자/관리자 UI에서 전체 시나리오, 최근 등록/수정 문서, 특정 키워드 포함 문서 목록 제공
  * 프론트엔드에서 "보이스피싱 관련 시나리오만 보기", "계좌번호가 포함된 금융퀴즈만 검색" 등 빠른 필터·정확 매칭에 최적
* Meilisearch는 일반 텍스트 기반 검색, Pinecone은 의미 기반(임베딩) 검색으로, 두 시스템을 병행 활용하면 사용자 편의성과 운영 효율성을 동시에 높일 수 있다.

## 5. 종합

* 복도리 금융교육/사기예방 시나리오 챗봇의 전체 구조는 다음과 같다.

  * 사용자 질의·대화: Pinecone(임베딩 벡터 데이터베이스) 기반 의미검색 + RAG + LLM으로 맞춤 답변
  * 운영/관리자·프론트엔드: Meilisearch(키워드/카테고리 검색엔진) 기반 초고속 목록·필터·검색
  * 전체 파이프라인 표준화와 협업/유지보수 효율성을 위해 LangChain을 중심으로 구현
* LLM 단독 사용은 최신 정보 부족·도메인 한계·사실성 미흡 문제, RAG와 Pinecone 결합으로 보완
* Pinecone(임베딩 벡터 DB)과 Meilisearch(키워드 검색엔진) 병행 도입은 실제 현업 AI 챗봇 개발에서도 검증된 구조이며, 분업, 유지보수, 성능 등 다양한 측면에서 장점이 크다.
